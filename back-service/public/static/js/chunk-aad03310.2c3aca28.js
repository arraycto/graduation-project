(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aad03310"],{"0402":function(t,e,n){},"163d":function(t,e,n){"use strict";var i=n("e7ad"),s=n("e042"),o=n("75c4"),r=n("1e5b"),u=n("94b3"),a=n("238a"),c=n("2ea2").f,l=n("dcb7").f,h=n("064e").f,p=n("777a").trim,f="Number",d=i[f],v=d,g=d.prototype,q=o(n("e005")(g))==f,m="trim"in String.prototype,b=function(t){var e=u(t,!1);if("string"==typeof e&&e.length>2){e=m?e.trim():p(e,3);var n,i,s,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,s=49;break;case 79:case 111:i=8,s=55;break;default:return+e}for(var r,a=e.slice(2),c=0,l=a.length;c<l;c++)if(r=a.charCodeAt(c),r<48||r>s)return NaN;return parseInt(a,i)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof d&&(q?a((function(){g.valueOf.call(n)})):o(n)!=f)?r(new v(b(e)),n,d):b(e)};for(var y,x=n("149f")?c(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;x.length>_;_++)s(v,y=x[_])&&!s(d,y)&&h(d,y,l(v,y));d.prototype=g,g.constructor=d,n("bf16")(i,f,d)}},"1c77":function(t,e,n){"use strict";var i=n("0402"),s=n.n(i);s.a},"2caf":function(t,e,n){},"4ecc":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"addQuestion-box"},[n("el-form",{ref:"form",attrs:{model:t.question,rules:t.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"题型"}},[n("el-select",{attrs:{placeholder:"请选择",disabled:!!t.questionInfo.type},on:{change:t.changeType},model:{value:t.question.type,callback:function(e){t.$set(t.question,"type",e)},expression:"question.type"}},t._l(t.questionTypes,(function(t){return n("el-option",{key:t.type,attrs:{label:t.name,value:t.type}})})),1)],1),t._v(" "),t.questionInfo.type?t._e():n("div",[n("el-form-item",{attrs:{label:"标题",prop:"title"}},[n("el-input",{attrs:{placeholder:"请求输入此题目的标题，用于在收藏列表中展示"},model:{value:t.question.title,callback:function(e){t.$set(t.question,"title",e)},expression:"question.title"}})],1)],1),t._v(" "),t.question.content?n("div",t._l(t.question.content,(function(e,i){return n("el-form-item",{key:i,attrs:{label:t.fieldTip[i],prop:"content."+i}},[-1!==t.useEditor.indexOf(i)?n("quill-editor",{model:{value:t.question.content[i],callback:function(e){t.$set(t.question.content,i,e)},expression:"question.content[index]"}}):"judges"===t.question.type&&"rightKey"===i?n("el-radio-group",{model:{value:t.question.content[i],callback:function(e){t.$set(t.question.content,i,e)},expression:"question.content[index]"}},t._l(t.judgeOptions,(function(t){return n("el-radio-button",{key:t,attrs:{label:t}})})),1):-1!==t.numberField.indexOf(i)?n("el-input",{attrs:{type:"number"},model:{value:t.question.content[i],callback:function(e){t.$set(t.question.content,i,t._n(e))},expression:"question.content[index]"}}):"essays"===t.question.type&&"rightKey"===i?n("el-input",{attrs:{type:"textarea",autosize:""},model:{value:t.question.content[i],callback:function(e){t.$set(t.question.content,i,e)},expression:"question.content[index]"}}):n("el-input",{model:{value:t.question.content[i],callback:function(e){t.$set(t.question.content,i,e)},expression:"question.content[index]"}})],1)})),1):t._e(),t._v(" "),n("el-form-item",[t._v("\n      参考答案格式："),n("br"),t._v("\n      1. 答案的前后注意不要有空格"),n("br"),t._v("\n      2. 单选题请在输入框中输入唯一到正确答案，如：A"),n("br"),t._v("\n      3. 多选题请将答案依次写在输入框中，每个答案之间不要有空格或者他符号，如：ABCD"),n("br"),t._v("\n      4. 判断题请选择正确答案即可"),n("br"),t._v("\n      5. 填空题中，每个答案请用空格隔开，如：A B C"),n("br"),t._v("\n      6. 问答题只需将答案写在输入框中即可，没有特殊要求"),n("br")]),t._v(" "),t.questionInfo.type?t._e():n("el-form-item",[n("el-button",{attrs:{icon:"el-icon-finished",type:"primary"},on:{click:t.save}},[t._v("保存")]),t._v(" "),n("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.changeType}},[t._v("重置")])],1)],1)],1)},s=[],o=(n("6d57"),n("e10e"),n("9a33"),n("c904"),n("f548"),n("cc57"),n("b881")),r={components:{quillEditor:o["quillEditor"]},data:function(){return{questionContent:{},questionTypes:[],question:{type:"",title:"",content:{}},judgeOptions:[],fieldTip:{},useEditor:["content","A","B","C","D","E","F"],numberField:["score","spaceNumber"],rules:{type:[{required:!0,message:"请选择题目类型",tigger:"blur"}],title:[{required:!0,message:"请填写题目的标题，便于展示",tigger:"blur"}],"content.content":[{required:!0,message:"请填写题目内容",tigger:"blur"}],"content.score":[{required:!0,type:"number",message:"请填写该题分数",tigger:"blur"}],"content.A":[{required:!0,message:"请填写该选项的内容",tigger:"blur"}],"content.B":[{required:!0,message:"请填写该选项的内容",tigger:"blur"}],"content.C":[{required:!0,message:"请填写该选项的内容",tigger:"blur"}],"content.D":[{required:!0,message:"请填写该选项的内容",tigger:"blur"}],"content.E":[{required:!0,message:"请填写该选项的内容",tigger:"blur"}],"content.F":[{required:!0,message:"请填写该选项的内容",tigger:"blur"}],"content.spaceNumber":[{required:!0,type:"number",message:"请填写该填空题的空格数",tigger:"blur"}],"content.rightKey":[{required:!0,message:"请填写正确答案",tigger:"blur"}]},state:"",isSaved:!1,questionInfo:{type:"",content:{}},from:"本人编辑"}},created:function(){this.questionContent=JSON.parse(JSON.stringify(this.$store.getters.constant.question.content)),this.questionTypes=this.$store.getters.constant.question.types,this.question.type=this.questionTypes[0].type,this.question.content=JSON.parse(JSON.stringify(this.questionContent[this.question.type])),this.fieldTip=this.$store.getters.constant.question.fieldTip,this.judgeOptions=this.$store.getters.constant.judgeOptions},methods:{changeType:function(t){this.$refs["form"].resetFields(),this.question.content=JSON.parse(JSON.stringify(this.questionContent[this.question.type]))},save:function(){var t=this,e=!0;if(this.$refs["form"].validate((function(t){e=t})),!e)return this.$message.warning("请先将试题信息完善再进行提交！"),!1;this.question.content.state=this.$store.getters.constant.question.state.collection,this.question.content.from=this.from,this.question.content.auth=this.$store.getters.userInfo.name,this.question.title&&(this.question.content.title=this.question.title),"essays"===this.question.type&&(this.question.content.rightKey=this.question.content.rightKey.replace(/\r\n/g,"<br/>").replace(/\n/g,"<br/>").replace(/\s/g,"&nbsp;")),-1!==["singles","multiples"].indexOf(this.question.type)&&(this.question.content.rightKey=this.question.content.rightKey.trim().split("").sort().join("").toLocaleUpperCase()),this.$store.dispatch("question/saveQuestion",this.question).then((function(e){t.$message.success(e.message),t.changeType()})).catch((function(){delete t.question.content.state}))},getQuestionInfo:function(){return this.question.content?(this.isSaved=!0,"essays"===this.question.type&&(this.question.content.rightKey=this.question.content.rightKey.replace(/\r\n/g,"<br/>").replace(/\n/g,"<br/>").replace(/\s/g,"&nbsp;")),"completions"===this.question.type&&(this.question.content.rightKey=this.question.content.rightKey.trim().split(" ").filter((function(t){return""!==t})).join(" ")),-1!==["singles","multiples"].indexOf(this.question.type)&&(this.question.content.rightKey=this.question.content.rightKey.trim().toLocaleUpperCase().split("").sort().join("")),this.question.content):""},isNeedSave:function(){if(this.isSaved)return!1;for(var t=this.question.content,e=Object.keys(t),n=0;n<e.length;n++)if(t[e[n]])return!0;return!1},changeQuestionInfo:function(t){var e=this;this.isSaved=!1,this.$refs["form"].resetFields(),this.question.type=t.type,this.changeType(t),this.questionInfo=t;var n=Object.keys(this.question.content);n.map((function(n){e.question.content[n]=t.content[n]||""}))}}},u=r,a=(n("d5a6"),n("9fdc"),n("e90a")),c=Object(a["a"])(u,i,s,!1,null,"61002682",null);e["a"]=c.exports},"777a":function(t,e,n){var i=n("e46b"),s=n("f6b4"),o=n("238a"),r=n("9769"),u="["+r+"]",a="​",c=RegExp("^"+u+u+"*"),l=RegExp(u+u+"*$"),h=function(t,e,n){var s={},u=o((function(){return!!r[t]()||a[t]()!=a})),c=s[t]=u?e(p):r[t];n&&(s[n]=c),i(i.P+i.F*u,"String",s)},p=h.trim=function(t,e){return t=String(s(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(l,"")),t};t.exports=h},8319:function(t,e,n){"use strict";var i=n("a33a"),s=n.n(i);s.a},"8acc":function(t,e,n){"use strict";var i=n("9f65"),s=n.n(i);s.a},9769:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},"9f65":function(t,e,n){},"9fdc":function(t,e,n){"use strict";var i=n("a257"),s=n.n(i);s.a},a257:function(t,e,n){},a2cd:function(t,e,n){"use strict";var i=n("238a");t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},a33a:function(t,e,n){},bc0e:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"edit-box"},[n("div",{staticClass:"tc"},[n("h2",[t._v(t._s(t.config.paperTitle))])]),t._v(" "),n("div",{staticClass:"tc"},[n("span",[t._v("试卷总分:"+t._s(t.config.totalScore))]),t._v("    "),n("span",[t._v("考试时间:"+t._s(t.config.time))])]),t._v(" "),n("div",{staticClass:"mt10 mb10"},[t._v("        "+t._s(t.config.text))]),t._v(" "),n("el-container",[n("el-aside",{attrs:{width:"200px"}},[n("el-scrollbar",{staticStyle:{height:"100%"}},[n("el-menu",{staticStyle:{border:"0"},attrs:{"default-active":t.currentQuestionIndex,"unique-opened":!0},on:{select:t.selectMenuItem}},t._l(t.questionList,(function(e){return n("el-submenu",{key:e.index,attrs:{index:e.index}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-s-promotion"}),t._v(t._s(e.index+"、"+e.name+"("+t.config[e.type+"Score"]+"分)"))]),t._v(" "),t._l(e.number,(function(i){return n("el-menu-item",{key:i,attrs:{index:e.type+"-"+i}},[t._v("题目"+t._s(i))])}))],2)})),1)],1)],1),t._v(" "),n("el-container",[n("el-main",[n("div",{staticStyle:{padding:"0 20px 0 100px"}},[n("el-button",{attrs:{icon:"el-icon-arrow-left",disabled:0===t.questionsIndex.indexOf(t.currentQuestionIndex)},on:{click:t.preQuestion}},[t._v("上一题")]),t._v(" "),n("el-button",{staticClass:"fr",attrs:{disabled:t.questionsIndex.indexOf(t.currentQuestionIndex)===t.questionsIndex.length-1},on:{click:t.nextQuestion}},[t._v("下一题 "),n("i",{staticClass:"el-icon-arrow-right"})]),t._v(" "),n("el-button",{staticClass:"fr",attrs:{icon:"el-icon-finished",type:"primary"},on:{click:t.saveQuestion}},[t._v("保存")]),t._v(" "),n("el-button",{staticClass:"fr",attrs:{type:"info"},on:{click:t.getCollection}},[n("svg-icon",{attrs:{"icon-class":"store"}}),t._v(" 题库")],1)],1),t._v(" "),t.showEditor?n("question-editor",{ref:"questionEditor",attrs:{"question-info":t.currentQuestion}}):t._e()],1)],1)],1),t._v(" "),n("back-to-top",{ref:"backToTop"}),t._v(" "),n("el-dialog",{attrs:{visible:t.visble},on:{"update:visible":function(e){t.visble=e}}},[n("span",{staticStyle:{color:"#666","font-weight":"700"},attrs:{slot:"title"},slot:"title"},[n("svg-icon",{attrs:{"icon-class":"store"}}),t._v(" 收藏列表")],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.collections,"max-height":"400"}},[n("el-table-column",{attrs:{label:"标题",prop:"title",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{ref:"popover1",attrs:{placement:"top-start",title:"试题",trigger:"hover"}},[n("div",{domProps:{innerHTML:t._s(e.row.content)}}),t._v(" "),n("span",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.title))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"分值",prop:"score",align:"center","show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{label:"来源",prop:"from",align:"center","show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{fix:"right",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.useCollection(e.row)}}},[n("svg-icon",{attrs:{"icon-class":"use"}}),t._v(" 使用")],1)]}}])})],1)],1)],1)},s=[],o=(n("cc57"),n("309f"),n("0b53"),n("6d57"),n("e10e"),n("9a33"),n("b449"),n("e980")),r=n("4ecc"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:t.transitionName}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"back-to-ceiling",style:t.customStyle,on:{click:t.backToTop}},[n("svg",{staticClass:"Icon Icon--backToTopArrow",staticStyle:{height:"16px",width:"16px"},attrs:{width:"16",height:"16",viewBox:"0 0 17 17",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"}},[n("path",{attrs:{d:"M12.036 15.59a1 1 0 0 1-.997.995H5.032a.996.996 0 0 1-.997-.996V8.584H1.03c-1.1 0-1.36-.633-.578-1.416L7.33.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.004z"}})])])])},a=[],c=(n("163d"),{name:"BackToTop",props:{visibilityHeight:{type:Number,default:400},backPosition:{type:Number,default:0},customStyle:{type:Object,default:function(){return{right:"50px",bottom:"50px",width:"40px",height:"40px","border-radius":"4px","line-height":"45px",background:"#e7eaf1"}}},transitionName:{type:String,default:"fade"}},data:function(){return{visible:!0,interval:null,isMoving:!1}},mounted:function(){window.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){window.removeEventListener("scroll",this.handleScroll),this.interval&&clearInterval(this.interval)},methods:{handleScroll:function(){this.visible=!0},backToTop:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.isMoving){var n=window.pageYOffset,i=0;this.isMoving=!0,this.interval=setInterval((function(){var s=Math.floor(t.easeInOutQuad(10*i,n,-n,500));s<=t.backPosition?(window.scrollTo(e,t.backPosition),clearInterval(t.interval),t.isMoving=!1):window.scrollTo(e,s),i++}),16.7)}},easeInOutQuad:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e}}}),l=c,h=(n("8acc"),n("e90a")),p=Object(h["a"])(l,u,a,!1,null,"582a6ee5",null),f=p.exports,d={name:"EditPaper",components:{questionEditor:r["a"],BackToTop:f},data:function(){return{config:{},chineseOrderNumber:[],questionTypes:[],questionContent:{},questions:{},currentQuestion:{},questionsIndex:[],currentQuestionIndex:"",questionList:[],showEditor:!0,collections:[],visble:!1}},created:function(){this.chineseOrderNumber=this.$store.getters.constant.chineseOrderNumber,this.questionTypes=this.$store.getters.constant.question.types,this.questionContent=JSON.parse(JSON.stringify(this.$store.getters.constant.question.content)),this.getPaperDetail()},methods:{getPaperDetail:function(){var t=this,e={paperId:this.$route.params.id};this.$store.dispatch("paper/getPaperDetail",e).then((function(e){t.config=e.data.config,t.initQuestions(),t.initQuestionList(),t.getPaperQuestions()})).catch((function(){t.$router.go(-1)}))},getPaperQuestions:function(){var t=this;this.$store.dispatch("question/getPaperQuestions",{paperId:this.$route.params.id}).then((function(e){t.coverRecord(e.data)}))},selectMenuItem:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.split("-"),this.currentQuestionIndex=e,this.currentQuestion.type=n[0],this.currentQuestion.content=this.questions[n[0]][n[1]]||{},this.$refs["questionEditor"].changeQuestionInfo(this.currentQuestion),setTimeout((function(){i.$refs["backToTop"].backToTop()}),200);case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),initQuestions:function(t){var e=this;this.questionTypes.filter((function(t){return e.config[t.type]})).map((function(t){e.questions[t.type]=[]}))},coverRecord:function(t){var e=this,n=Object.keys(this.questions);n.map((function(n){if(t[n]){var i=!0,s=!1,o=void 0;try{for(var r,u=t[n][Symbol.iterator]();!(i=(r=u.next()).done);i=!0){var a=r.value;e.questions[n][a.orderNumber]=a}}catch(c){s=!0,o=c}finally{try{i||null==u.return||u.return()}finally{if(s)throw o}}}})),this.selectMenuItem(this.currentQuestionIndex)},initQuestionList:function(){var t=this;this.questionsIndex=[];var e=0;this.questionList=this.questionTypes.filter((function(e){return t.config[e.type]})).map((function(n){for(var i={index:t.chineseOrderNumber[e],name:n.name,type:n.type,number:t.config[n.type]},s=1;s<=i.number;s++)t.questionsIndex.push("".concat(i.type,"-").concat(s));return e++,i})),this.selectMenuItem(this.questionsIndex[0])},preQuestion:function(){var t=this.questionsIndex.indexOf(this.currentQuestionIndex)-1;if(t<0)return this.$message.error("索引出错，请刷新页面重试！"),!1;this.selectMenuItem(this.questionsIndex[t])},nextQuestion:function(){var t=this.questionsIndex.indexOf(this.currentQuestionIndex)+1;if(t>=this.questionsIndex.length)return this.$message.error("索引出错，请刷新页面重试！"),!1;this.selectMenuItem(this.questionsIndex[t])},saveQuestion:function(){var t=this,e=this.currentQuestionIndex.split("-"),n=this.questions[e[0]][e[1]]||{};for(var i in Object.assign(n,this.$refs["questionEditor"].getQuestionInfo()),n)"string"===typeof n[i]&&n[i].trim();n.orderNumber=+e[1],n.paperId=this.$route.params.id,this.questions[e[0]][e[1]]=n;var s={content:n,type:e[0]};n.qid&&(s.qid=n.qid),this.$store.dispatch("question/saveQuestion",s).then((function(n){t.$message.success("保存成功！"),n.data&&(t.questions[e[0]][e[1]].qid=n.data.qid)}))},getCollection:function(){var t=this,e=this.currentQuestionIndex.split("-"),n={state:this.$store.getters.constant.question.state.collection,type:e[0]};this.$store.dispatch("question/getCollecQuestions",n).then((function(e){t.collections=e.data,t.visble=!0}))},useCollection:function(t){var e=this.currentQuestionIndex.split("-"),n=Object.keys(this.questionContent[e[0]]),i={};n.map((function(e){i[e]=t[e]})),this.questions[e[0]][e[1]]&&this.questions[e[0]][e[1]].qid&&(i.qid=this.questions[e[0]][e[1]].qid),this.questions[e[0]][e[1]]=i,this.selectMenuItem(this.currentQuestionIndex),this.visble=!1}}},v=d,g=(n("8319"),n("1c77"),Object(h["a"])(v,i,s,!1,null,"91317e4e",null));e["default"]=g.exports},c904:function(t,e,n){"use strict";var i=n("e46b"),s=n("5daa"),o=n("008a"),r=n("238a"),u=[].sort,a=[1,2,3];i(i.P+i.F*(r((function(){a.sort(void 0)}))||!r((function(){a.sort(null)}))||!n("a2cd")(u)),"Array",{sort:function(t){return void 0===t?u.call(o(this)):u.call(o(this),s(t))}})},d5a6:function(t,e,n){"use strict";var i=n("2caf"),s=n.n(i);s.a}}]);