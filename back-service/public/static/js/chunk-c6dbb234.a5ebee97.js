(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c6dbb234"],{"0346":function(e,s,t){},"079a":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"user-box"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("user-card")],1),e._v(" "),t("el-col",{attrs:{span:18}},[t("el-card",[t("el-tabs",{model:{value:e.activeTab,callback:function(s){e.activeTab=s},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"个人信息",name:"account"}},[t("changeInfo")],1),e._v(" "),t("el-tab-pane",{attrs:{label:"更改头像",name:"headIcon"}},[t("changeHeadIcon")],1),e._v(" "),t("el-tab-pane",{attrs:{label:"更改密码",name:"password"}},[t("changePassword")],1)],1)],1)],1)],1)],1)},r=[],n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("el-card",{staticClass:"user-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",{staticClass:"user-title"},[e._v("关于我")])]),e._v(" "),t("div",{staticClass:"user-headIcon"},[t("el-image",{attrs:{src:e.userInfo.headIcon||e.defaultHeadIcon,"preview-src-list":[e.userInfo.headIcon||e.defaultHeadIcon]}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])])],1),e._v(" "),t("div",{staticClass:"middle"},[t("div",{staticClass:"name"},[e._v(e._s(e.userInfo.name))]),e._v(" "),t("div",{staticClass:"role"},[e._v(e._s({T:"教师",S:"学生"}[e.userInfo.role]))])]),e._v(" "),t("div",{staticClass:"info-box"},[t("div",{staticClass:"info"},[t("span",{staticClass:"info-title"},[e._v("学校：")]),e._v(" "),t("span",{staticClass:"info-content"},[e._v(e._s(e.userInfo.school))])]),e._v(" "),t("div",{staticClass:"info"},[t("span",{staticClass:"info-title"},[e._v("专业：")]),e._v(" "),t("span",{staticClass:"info-content"},[e._v(e._s(e.userInfo.major))])]),e._v(" "),t("div",{staticClass:"info"},[t("span",{staticClass:"info-title"},[e._v("班级：")]),e._v(" "),t("span",{staticClass:"info-content"},[e._v(e._s(e.userInfo.class))])]),e._v(" "),t("div",{staticClass:"info"},[t("span",{staticClass:"info-title"},[e._v("学号：")]),e._v(" "),t("span",{staticClass:"info-content"},[e._v(e._s(e.userInfo.number))])]),e._v(" "),t("div",{staticClass:"info"},[t("span",{staticClass:"info-title"},[e._v("性别：")]),e._v(" "),t("span",{staticClass:"info-content"},[e._v(e._s(["女","男"][e.userInfo.sex]))])]),e._v(" "),t("div",{staticClass:"info"},[t("span",{staticClass:"info-title"},[e._v("年龄：")]),e._v(" "),t("span",{staticClass:"info-content"},[e._v(e._s(e.userInfo.age))])])])])},o=[],l={name:"UserCard",components:{},data:function(){return{defaultHeadIcon:""}},computed:{userInfo:function(){return this.$store.getters.userInfo}},created:function(){this.defaultHeadIcon=this.$store.getters.constant.defaultHeadIcon},methods:{}},i=l,c=(t("f159"),t("e90a")),u=Object(c["a"])(i,n,o,!1,null,"1d56aade",null),f=u.exports,d=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("el-form",{ref:"registerForm",attrs:{model:e.userInfo,rules:e.rules,"label-width":"80px"}},[t("el-scrollbar",{staticClass:"register-scrollbar"},[t("el-form-item",{attrs:{label:"账号",prop:"account"}},[t("el-input",{attrs:{placeholder:"请输入您的账号(建议使用学号)",disabled:""},model:{value:e.userInfo.account,callback:function(s){e.$set(e.userInfo,"account",s)},expression:"userInfo.account"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入您的姓名(建议使用真实姓名)"},model:{value:e.userInfo.name,callback:function(s){e.$set(e.userInfo,"name",s)},expression:"userInfo.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"身份",prop:"role"}},[t("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.userInfo.role,callback:function(s){e.$set(e.userInfo,"role",s)},expression:"userInfo.role"}},e._l(e.roleOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"学校",prop:"school"}},[t("el-input",{attrs:{placeholder:"请输入您的学校"},model:{value:e.userInfo.school,callback:function(s){e.$set(e.userInfo,"school",s)},expression:"userInfo.school"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"专业",prop:"major"}},[t("el-input",{attrs:{placeholder:"请输入您的专业"},model:{value:e.userInfo.major,callback:function(s){e.$set(e.userInfo,"major",s)},expression:"userInfo.major"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"班级",prop:"class"}},[t("el-input",{attrs:{placeholder:"请输入您的班级"},model:{value:e.userInfo.class,callback:function(s){e.$set(e.userInfo,"class",s)},expression:"userInfo.class"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"学号",prop:"number"}},[t("el-input",{attrs:{placeholder:"请输入您的学号"},model:{value:e.userInfo.number,callback:function(s){e.$set(e.userInfo,"number",s)},expression:"userInfo.number"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"年龄",prop:"age"}},[t("el-input",{attrs:{placeholder:"请输入您的年龄"},model:{value:e.userInfo.age,callback:function(s){e.$set(e.userInfo,"age",s)},expression:"userInfo.age"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"性别",prop:"sex"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.userInfo.sex,callback:function(s){e.$set(e.userInfo,"sex",s)},expression:"userInfo.sex"}},e._l(e.sexOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),t("div",{staticClass:"form-button"},[t("el-button",{attrs:{icon:"el-icon-finished",type:"primary"},on:{click:e.submitForm}},[e._v("确认更改")]),e._v(" "),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.resetForm}},[e._v("撤销更改")])],1)],1)],1)},p=[],m={name:"ChangeInfo",components:{},data:function(){return{userInfo:{},rules:{account:[{required:!0,message:"请输入账号",tigger:"blur"}],name:[{required:!0,message:"请输入姓名",tigger:"blur"}],role:[{required:!0,message:"请选择职业",tigger:"blur"}],school:[{required:!0,message:"请输入学校",tigger:"blur"}],major:[{required:!0,message:"请输入专业",tigger:"blur"}],class:[{required:!0,message:"请输入班级",tigger:"blur"}],number:[{required:!0,message:"请输入学号",tigger:"blur"}],password:[{required:!0,message:"请输入密码",tigger:"blur"}]},roleOptions:[{value:"T",label:"教师"},{value:"S",label:"学生"}],sexOptions:[{value:0,label:"女"},{value:1,label:"男"}]}},created:function(){this.userInfo=this.deepCopy(this.$store.getters.userInfo),this.userInfo.sex=+this.userInfo.sex},methods:{submitForm:function(){var e=this;this.$store.dispatch("user/setInfo",this.userInfo).then((function(s){e.$message({message:"用户信息更新成功",type:"success"}),e.$store.dispatch("user/getInfo")}))},deepCopy:function(e){return JSON.parse(JSON.stringify(e))},resetForm:function(){this.userInfo=this.deepCopy(this.$store.getters.userInfo),this.userInfo.sex=+this.userInfo.sex}}},v=m,h=Object(c["a"])(v,d,p,!1,null,"3a5e1c37",null),b=h.exports,g=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"changeHeadIcon-box"},[t("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:e.action,"show-file-list":!1,"auto-upload":!1,"on-change":e.changeImg,headers:e.headers,data:e.params,"on-success":e.uploadSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?t("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过5M")])]),e._v(" "),t("div",{staticClass:"change-button"},[t("el-button",{attrs:{icon:"el-icon-upload2",type:"primary"},on:{click:e.submitHeadIcon}},[e._v("更改头像")])],1)],1)},_=[],I={name:"ChangeHeadIcon",components:{},data:function(){return{imageUrl:"",params:{type:"headIcon"}}},computed:{action:function(){return"/image/saveHeadIcon"},headers:function(){return{"x-token":this.$store.getters.token}}},methods:{changeImg:function(e,s){s.length=0,s.push(e),this.imageUrl=URL.createObjectURL(e.raw)},submitHeadIcon:function(){this.$refs["upload"].submit()},uploadSuccess:function(e,s,t){200===e.code&&(this.$message({message:"头像更改成功",type:"success"}),this.$refs["upload"].clearFiles(),this.imageUrl=""),this.$store.dispatch("user/getInfo")},beforeAvatarUpload:function(e){var s=e.size/1024/1024<5,t=["image/jpeg","image/png"],a=-1!==t.indexOf(e.type);return s||this.$message.error("图片大小不得超过5M!"),a||this.$message.error("图片格式只支持"+t.join(",")),s&&a}}},w=I,C=(t("9e69"),t("ee87"),Object(c["a"])(w,g,_,!1,null,"ee79bec8",null)),x=C.exports,$=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"changePassword-box"},[t("el-form",{ref:"form",attrs:{model:e.passwords,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"旧密码",prop:"old"}},[t("el-input",{attrs:{type:"password","show-password":"",placeholder:"请输入旧密码"},model:{value:e.passwords.old,callback:function(s){e.$set(e.passwords,"old",s)},expression:"passwords.old"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"新密码",prop:"newOne"}},[t("el-input",{attrs:{type:"password","show-password":"",placeholder:"请输入新密码"},model:{value:e.passwords.newOne,callback:function(s){e.$set(e.passwords,"newOne",s)},expression:"passwords.newOne"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"确认密码",prop:"newConfirm"}},[t("el-input",{attrs:{type:"password","show-password":"",placeholder:"请再次输入新密码"},model:{value:e.passwords.newConfirm,callback:function(s){e.$set(e.passwords,"newConfirm",s)},expression:"passwords.newConfirm"}})],1),e._v(" "),t("div",{staticClass:"form-button"},[t("el-button",{staticClass:"fr",attrs:{icon:"el-icon-finished",type:"primary"},on:{click:e.submitForm}},[e._v("确认更改")]),e._v(" "),t("el-button",{staticClass:"fr mr10",attrs:{icon:"el-icon-refresh-left"},on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)},k=[],O=(t("b449"),t("e980")),y={data:function(){return{passwords:{old:"",newOne:"",newConfirm:""},rules:{old:[{required:!0,message:"请输入旧密码",tigger:"blur"}],newOne:[{required:!0,message:"请输入新密码",tigger:"blur"}],newConfirm:[{required:!0,message:"请再次输入新密码",tigger:"blur"}]}}},methods:{submitForm:function(){var e=this,s=!0;if(this.$refs["form"].validate((function(e){s=!e})),s)return!1;if(this.passwords.newOne.trim()!==this.passwords.newConfirm.trim())return this.$message.warning("两次输入的新密码不一致！"),!1;var t={old:this.passwords.old.trim(),newOne:this.passwords.newOne.trim()};this.$store.dispatch("user/changePassword",t).then(function(){var s=Object(O["a"])(regeneratorRuntime.mark((function s(t){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.$message.success("密码更新成功，请重新登录！"),s.next=3,e.$store.dispatch("user/logout");case 3:e.$router.push("/login"),e.$store.state.tagsView.visitedViews=[];case 5:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}())},resetForm:function(){this.$refs["form"].resetFields()}}},j=y,H=(t("7e0a"),Object(c["a"])(j,$,k,!1,null,"485dbfcb",null)),q=H.exports,F={name:"UserInfo",components:{userCard:f,changeInfo:b,changeHeadIcon:x,changePassword:q},data:function(){return{activeTab:"account"}},created:function(){},methods:{}},U=F,S=(t("33cc"),Object(c["a"])(U,a,r,!1,null,"49a31069",null));s["default"]=S.exports},"2e97":function(e,s,t){},"33cc":function(e,s,t){"use strict";var a=t("0346"),r=t.n(a);r.a},"7e0a":function(e,s,t){"use strict";var a=t("2e97"),r=t.n(a);r.a},"7f36":function(e,s,t){},"874e":function(e,s,t){},"8b95":function(e,s,t){},"9e69":function(e,s,t){"use strict";var a=t("7f36"),r=t.n(a);r.a},ee87:function(e,s,t){"use strict";var a=t("874e"),r=t.n(a);r.a},f159:function(e,s,t){"use strict";var a=t("8b95"),r=t.n(a);r.a}}]);