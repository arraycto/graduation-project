(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76b47144"],{5741:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"markBox",staticClass:"mark-box backgroundGray"},[s("el-row",{attrs:{gutter:32}},[s("el-col",{staticClass:"paper",attrs:{span:16}},[s("el-scrollbar",{staticClass:"scrollbar-box"},e._l(e.paper,(function(t){return s("div",{key:t.index},[s("h4",[e._v(e._s(t.index)+"、"+e._s(t.name))]),e._v(" "),e._l(t.questions,(function(n,i){return s("div",{key:i},[0!==i?s("div",[s("div",{staticClass:"flex-box"},[s("span",{staticStyle:{"line-height":"50px"}},[e._v(e._s(i)+"、")]),e._v(" "),s("div",{staticClass:"issues",domProps:{innerHTML:e._s(n.content)}})]),e._v(" "),n[e.selectOptions[0]]?s("div",e._l(e.selectOptions,(function(t){return s("div",{key:t},[n[t]?s("div",{staticClass:"flex-box"},[s("span",{staticStyle:{"line-height":"50px"}},[e._v(e._s(t)+"、")]),e._v(" "),s("span",{domProps:{innerHTML:e._s(n[t])}})]):e._e()])})),0):e._e(),e._v(" "),s("p",[e._v("参考答案："),s("span",{domProps:{innerHTML:e._s(n.rightKey)}})]),e._v(" "),s("p",[e._v("考生答案：\n                "),"essays"!==t.type?s("span",{class:{green:null!==n.isTrue&&n.isTrue,red:null!==n.isTrue&&!n.isTrue}},[e._v(e._s(n.mineAnswer))]):e._e(),e._v(" "),"essays"===t.type?s("span",{class:{green:null!==n.isTrue&&n.isTrue,red:null!==n.isTrue&&!n.isTrue},domProps:{innerHTML:e._s(n.mineAnswer)}}):e._e(),e._v(" "),null!=n.isTrue&&n.isTrue?s("i",{staticClass:"isTrue-tip green el-icon-check"}):e._e(),e._v(" "),null==n.isTrue||n.isTrue?e._e():s("i",{staticClass:"isTrue-tip red el-icon-close"})]),e._v(" "),s("p",[e._v("分值："+e._s(n.score))]),e._v(" "),s("div",{staticClass:"flex-box"},[s("div",{staticStyle:{width:"60px","line-height":"40px"}},[e._v("得分: ")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{type:"number",min:0,max:n.score},model:{value:n.newScore,callback:function(t){e.$set(n,"newScore",t)},expression:"unit.newScore"}}),e._v(" "),s("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:function(s){return e.changeScore(n.oldScore,n.newScore,n,t.type,n.score)}}},[s("svg-icon",{attrs:{"icon-class":"save"}}),e._v("\n                  保存\n                ")],1)],1)]):e._e()])}))],2)})),0)],1),e._v(" "),s("el-col",{staticStyle:{position:"relative"},attrs:{span:8}},[s("el-card",{staticClass:"fix-card"},[s("h4",{staticStyle:{margin:"0"},attrs:{slot:"header"},slot:"header"},[e._v("考生列表")]),e._v(" "),s("el-scrollbar",{staticClass:"scrollbar-box-1"},[s("el-menu",{attrs:{"default-active":e.currentRecord}},e._l(e.overall,(function(t,n){return s("el-menu-item",{key:t.eid,attrs:{index:t.eid},on:{click:function(s){return e.setAnswer(t.eid,t)}}},[e._v("\n              "+e._s(n+1)+"、"+e._s(t.user.name)+"\n              "),s("div",{staticClass:"fr"},[e._v("\n                "+e._s(t.scoreExam)+" 分\n              ")])])})),1)],1)],1)],1)],1)],1)},i=[],r=(s("cc57"),s("5bc8")),a={mixins:[r["a"]],data:function(){return{config:{},questions:{},questionTypes:[],chineseOrderNumber:[],paper:[],selectOptions:[],overall:"",examNumber:0,currentRecord:"1"}},created:function(){this.questionTypes=this.$store.getters.constant.question.types,this.chineseOrderNumber=this.$store.getters.constant.chineseOrderNumber,this.selectOptions=this.$store.getters.constant.selectOptions,this.getPaperConfig()},methods:{getPaperConfig:function(){var e=this,t={paperId:this.$route.query.p};this.openLoad(),this.$store.dispatch("paper/getPaperDetail",t).then((function(t){e.config=t.data.config,e.getPaperQuestions()})).catch((function(){e.$router.go(-1),e.closeLoad()}))},getPaperQuestions:function(){var e=this,t=this.$route.query.p;this.$store.dispatch("question/getPaperQuestions",{paperId:t}).then((function(t){var s=t.data,n=function(t){s[t].map((function(s){e.questions[t]||(e.questions[t]=[]),e.questions[t][s.orderNumber]=s}))};for(var i in s)n(i);e.initPaper(),e.getExamineeList()})).catch((function(){e.closeLoad()}))},initPaper:function(){var e=this,t=0;this.paper=this.questionTypes.filter((function(t,s){return e.config[t.type]})).map((function(s){var n={index:e.chineseOrderNumber[t],name:s.name,type:s.type,questions:e.questions[s.type]};return t++,n}))},getExamineeList:function(){var e=this,t={paperId:this.$route.query.p};this.$store.dispatch("exam/getExamOverallByPid",t).then((function(t){e.overall=t.data,e.examNumber=e.overall.length,e.overall[0].eid&&(e.currentRecord=e.overall[0].eid,e.setAnswer(e.overall[0].eid,e.overall[0]))})).finally((function(){e.closeLoad()}))},setAnswer:function(e,t){this.currentRecord=e;for(var s=t.answerRecords,n=0,i=this.paper.length;n<i;n++)for(var r=this.paper[n].questions,a=0,o=r.length;a<o;a++)if(r[a])for(var c=0,l=s.length;c<l;c++)if(r[a].qid===s[c].qid){this.$set(r[a],"isTrue",s[c].isTrue),this.$set(r[a],"mineAnswer",s[c].mineAnswer),this.$set(r[a],"oldScore",null==s[c].isTrue?"":s[c].score),this.$set(r[a],"newScore",r[a].oldScore);break}},changeScore:function(e,t,s,n,i){var r=this;if(t=+t,e=+e,t>i)return this.$message.warning("所给分值超过了本题的最大分值，无法保存！"),!1;var a=t-e;s.oldScore=t,s.isTrue=0!==t;for(var o=-1,c=0,l=this.overall.length;c<l;c++)if(this.overall[c].eid===this.currentRecord){this.overall[c].scoreExam+=a,o=this.overall[c].scoreExam;for(var u=this.overall[c].answerRecords,d=0,p=u.length;d<p;d++)if(u[d].qid===s.qid){u[d].score=t,u[d].isTrue=0!==t;break}break}if(-1===o)this.$message.warning("分数计算出错，无法进行保存！");else{var h={eid:this.currentRecord,qid:s.qid,type:n,totalScore:o,newScore:t,gap:a};this.$store.dispatch("exam/changeScore",h).then((function(e){r.$message.success("保存成功！")}))}}}},o=a,c=(s("9a0a"),s("5eb4"),s("e90a")),l=Object(c["a"])(o,n,i,!1,null,"79072046",null);t["default"]=l.exports},"5bc8":function(e,t,s){"use strict";t["a"]={data:function(){return{load:null}},beforeMount:function(){},beforeDestroy:function(){},mounted:function(){},methods:{computedIndex:function(e){return(this.page-1)*this.pageSize+e+1},formatTime:function(e){return this.$moment(e).format("YYYY-MM-DD HH:mm:ss")},openLoad:function(e){this.load=this.$loading({target:e})},closeLoad:function(){this.load&&this.load.close()}}}},"5eb4":function(e,t,s){"use strict";var n=s("652b"),i=s.n(n);i.a},"652b":function(e,t,s){},"8ff8":function(e,t,s){},"9a0a":function(e,t,s){"use strict";var n=s("8ff8"),i=s.n(n);i.a}}]);